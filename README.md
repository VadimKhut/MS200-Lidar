# ORADAR ROS package

Пакет ORADAR ROS используется для подключения лидара Oradar MS200. Этот пакет ROS поддерживает среду ROS и ROS2. 
Среди них ROS поддерживает Indigo, Kinetic, Melodic и другие версии ROS; ROS2 поддерживает версию Ubuntu 20.04 ROS2 foxy и выше.

## инструкции： 

1. Установите среду ROS в систему. Конкретный метод установки можно найти по ссылке ниже:

    Ссылка для установки ROS: http://wiki.ros.org/kinetic/Installation/Ubuntu

    Ссылка для установки ROS2: https://docs.ros.org/en/foxy/Installation/Ubuntu-Install-Debians.html.

    **Пожалуйста, не устанавливайте ROS и ROS2 на один и тот же компьютер одновременно, чтобы избежать возможных конфликтов версий 
	и проблем с установкой других библиотек вручную**

2. Скопируйте исходный код oradar_ros в каталог src рабочего каталога ros и измените соответствующие файлы.

   ```shell
   mkdir -p ~/lidar_ros_ws/src
   cp -ar oradar_ros ~/lidar_ros_ws/src/
   ```

   (1) При использовании ROS вам необходимо открыть файл *CMakeLists.txt* в корневом каталоге исходного кода oradar_ros и 
      изменить переменную **COMPILE_METHOD** в верхней части файла на **CATKIN**,

   ```cmake
   #=======================================
   # Compile setup (ORIGINAL,CATKIN,COLCON)
   #=======================================
   set(COMPILE_METHOD CATKIN)
   ```

   Затем скопируйте файл *package_ros1.xml* и назовите его *package.xml*.

   (2) При использовании ROS2 вам необходимо открыть файл *CMakeLists.txt* в корневом каталоге исходного кода oradar_ros и 
      изменить переменную **COMPILE_METHOD** в верхней части файла на **COLCON**.

   ```cmake
   #=======================================
   # Compile setup (ORIGINAL,CATKIN,COLCON)
   #=======================================
   set(COMPILE_METHOD COLCON)
   ```

   Затем скопируйте файл *package_ros2.xml* и назовите его *package.xml*.


3. Скомпилируйте проект и установите переменные среды.

    Когда среда представляет собой ROS:

   ```shell
   cd ~/lidar_ros_ws
   catkin_make
   source devel/setup.sh
   ```

   Когда среда ROS2:

   ```
   cd ~/lidar_ros_ws
   colcon build
   source install/setup.bash
   ```

4. Настройте последовательный порт верхнего компьютера.

    Настройте имя последовательного порта и скорость передачи данных: имя_порта конфигурации по умолчанию — /dev/ttyACM0, а скорость передачи данных — 230400.

5. Настройте параметры радара.

    Откройте oradar_ros/launch/ms200_scan.launch для настройки параметров или oradar_ros/launch/ms200_scan.launch.py ​​для настройки параметров.

    Параметры описаны следующим образом:

   | имя параметра| тип данных | описание                                                                                                            |
   | -----------  | --------   | --------------------------------------------------------------------------------------------------------------------|
   | frame_id     | string     | Имя системы координат LiDAR. По умолчанию — laser_frame.                                                            |
   | scan_topic   | string     | Название темы LaserScan. По умолчанию используется сканирование                                                     |
   | port_name    | string     | Имя последовательного порта LiDAR. По умолчанию — /dev/ttyACM0.                                                     |
   | baudrate     | int        | Скорость передачи данных последовательного порта радара. Значение по умолчанию — 230400.                            |
   | angle_min    | double     | Минимальный угол, единица измерения градус, диапазон значений [0, 360]. Значение по умолчанию: 0                    |
   | angle_max    | double     | Максимальный угол, единица измерения градус, диапазон значений [0, 360]. Значение по умолчанию — 360.               |
   | range_min    | double     | Минимальное расстояние в метрах, значение по умолчанию — 0,05.                                                      |
   | range_max    | double     | Максимальное расстояние в метрах, значение по умолчанию — 20,0.                                                     |
   | clockwise    | bool       | Настройте направление облака точек: true — по часовой стрелке, false — против часовой стрелки. По умолчанию — false |
   | motor_speed  | int        | Скорость радара, единица Гц, диапазон значений 5~15Гц. Значение по умолчанию — 10 Гц.                               |

   

6. Запускаем узел Oradar ros.

    Когда среда представляет собой ROS:

   ```shell
   roslaunch oradar_lidar ms200_scan.launch
   или
   roslaunch oradar_lidar ms200_scan_view.launch (使用rviz显示) 
   ```

   Когда среда ROS2:

   ```
   ros2 launch oradar_lidar ms200_scan.launch.py
   или
   ros2 launch oradar_lidar ms200_scan_view.launch.py (отображается с помощью rviz2)
   ```

   
